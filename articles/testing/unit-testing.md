# Unit Testing

## 単体テストの必要性

時間対効果が大事。
良い単体テストが書けていると、ビジネス要求にも迅速に対応できる。
良くない単体テストの場合は、効果が小さいだけでなく、保守するのにも時間がかかってしまう。
膨大なテストが原因で開発の時間が少なくなり、その結果バグが発生することもある。
労力に見合った結果を引き出す単体テストを作成することが大事。

## 単体テストと設計との関係

単体テストのプラクティスを実施すれば、設計はより優れたものになる。
単体テストが作成しづらいのであれば、そのコードは密結合である可能性が高い。
コードが疎結合であっても、良い設計であるとは限らない。

## 単体テストの目標

単体テストの目標は、「ソフトウェア開発プロジェクトの成長を持続可能なものにする」こと。
テストがないプロジェクトは、初めは順調に成長するが、徐々に鈍化していく。
開発スピードが急に落ちる現象はソフトウェアエントロピー（無秩序の量）の増加によって起こる。

コードを変更したあとリファクタリングをしないとエントロピーが増加し、バグがバグを生むことに繋がる。
しかし、テストがあればバグを検出することができる。

## テストの質を良くするもの、悪くするもの

テストの質が悪い場合、初めのうちは効果はあるが、時間が経つにつれテストがない場合とかかる労力が変わらなくなっていく。

テストスイートとは、目的や対象ごとにテストケースを集めたもの。

ソフトウェアの質を向上するテストケースもあれば、逆もある。
テストケースの質が悪ければ、

- バグなのに失敗しない
- バグでないのに失敗する
- テストの実行時間がかかる

時間対効果を考慮する必要がある。
テストが増えることによる時間コストは、以下の作業によって増加する。

- プロダクションコードのリファクタリングに伴うテストコードのリファクタリング
- テストの実行時間
- テストが間違って失敗した際にその対処をすること
- プロダクションコードを理解するためにテストコードを読むこと

単にテストケースを増やせばいいということではない。
コードは資産ではなく、負債である。
テストコードも同じであり、プロダクションコードの一部として見なくてはならない。
